{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.postRedirectUrlToParent = exports.setupIframeListener = exports.redirectInIframe = void 0;\nlet redirectIframe;\n\nfunction getRedirectIframe() {\n  if (typeof redirectIframe === \"undefined\") {\n    redirectIframe = window.document.createElement(\"iframe\");\n    redirectIframe.setAttribute(\"hidden\", \"true\");\n    redirectIframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin\");\n  }\n\n  return redirectIframe;\n}\n\nfunction redirectInIframe(redirectUrl) {\n  const iframe = getRedirectIframe();\n  window.document.body.appendChild(iframe);\n  iframe.src = redirectUrl;\n}\n\nexports.redirectInIframe = redirectInIframe;\n\nfunction setupIframeListener(handleIframeRedirect) {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n\n  window.addEventListener(\"message\", async evt => {\n    const iframe = getRedirectIframe();\n\n    if (evt.origin === window.location.origin && evt.source === iframe.contentWindow) {\n      if (typeof evt.data.redirectUrl === \"string\") {\n        await handleIframeRedirect(evt.data.redirectUrl);\n      }\n    }\n\n    if (window.document.body.contains(iframe)) {\n      window.document.body.removeChild(iframe);\n    }\n  });\n}\n\nexports.setupIframeListener = setupIframeListener;\n\nfunction postRedirectUrlToParent(redirectUrl) {\n  window.top.postMessage({\n    redirectUrl\n  }, window.location.origin);\n}\n\nexports.postRedirectUrlToParent = postRedirectUrlToParent;","map":{"version":3,"sources":["../src/iframe.ts"],"names":[],"mappings":";;;;;;AAyBA,IAAI,cAAJ;;AAIA,SAAS,iBAAT,GAA0B;AACxB,MAAI,OAAO,cAAP,KAA0B,WAA9B,EAA2C;AACzC,IAAA,cAAc,GAAG,MAAM,CAAC,QAAP,CAAgB,aAAhB,CAA8B,QAA9B,CAAjB;AACA,IAAA,cAAc,CAAC,YAAf,CAA4B,QAA5B,EAAsC,MAAtC;AACA,IAAA,cAAc,CAAC,YAAf,CAA4B,SAA5B,EAAuC,iCAAvC;AACD;;AACD,SAAO,cAAP;AACD;;AASD,SAAgB,gBAAhB,CAAiC,WAAjC,EAAoD;AAClD,QAAM,MAAM,GAAG,iBAAiB,EAAhC;AACA,EAAA,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,WAArB,CAAiC,MAAjC;AACA,EAAA,MAAM,CAAC,GAAP,GAAa,WAAb;AACD;;AAJD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;AAgBA,SAAgB,mBAAhB,CACE,oBADF,EACiE;AAO/D,MAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AACjC;AACD;;AACD,EAAA,MAAM,CAAC,gBAAP,CAAwB,SAAxB,EAAmC,MAAO,GAAP,IAA4B;AAC7D,UAAM,MAAM,GAAG,iBAAiB,EAAhC;;AACA,QACE,GAAG,CAAC,MAAJ,KAAe,MAAM,CAAC,QAAP,CAAgB,MAA/B,IACA,GAAG,CAAC,MAAJ,KAAe,MAAM,CAAC,aAFxB,EAGE;AACA,UAAI,OAAO,GAAG,CAAC,IAAJ,CAAS,WAAhB,KAAgC,QAApC,EAA8C;AAE5C,cAAM,oBAAoB,CAAC,GAAG,CAAC,IAAJ,CAAS,WAAV,CAA1B;AACD;AACF;;AAED,QAAI,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,QAArB,CAA8B,MAA9B,CAAJ,EAA2C;AACzC,MAAA,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,WAArB,CAAiC,MAAjC;AACD;AACF,GAfD;AAgBD;;AA3BD,OAAA,CAAA,mBAAA,GAAA,mBAAA;;AAiCA,SAAgB,uBAAhB,CAAwC,WAAxC,EAA2D;AACzD,EAAA,MAAM,CAAC,GAAP,CAAW,WAAX,CACE;AACE,IAAA;AADF,GADF,EAIE,MAAM,CAAC,QAAP,CAAgB,MAJlB;AAMD;;AAPD,OAAA,CAAA,uBAAA,GAAA,uBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.postRedirectUrlToParent = exports.setupIframeListener = exports.redirectInIframe = void 0;\nlet redirectIframe;\nfunction getRedirectIframe() {\n    if (typeof redirectIframe === \"undefined\") {\n        redirectIframe = window.document.createElement(\"iframe\");\n        redirectIframe.setAttribute(\"hidden\", \"true\");\n        redirectIframe.setAttribute(\"sandbox\", \"allow-scripts allow-same-origin\");\n    }\n    return redirectIframe;\n}\nfunction redirectInIframe(redirectUrl) {\n    const iframe = getRedirectIframe();\n    window.document.body.appendChild(iframe);\n    iframe.src = redirectUrl;\n}\nexports.redirectInIframe = redirectInIframe;\nfunction setupIframeListener(handleIframeRedirect) {\n    if (typeof window === \"undefined\") {\n        return;\n    }\n    window.addEventListener(\"message\", async (evt) => {\n        const iframe = getRedirectIframe();\n        if (evt.origin === window.location.origin &&\n            evt.source === iframe.contentWindow) {\n            if (typeof evt.data.redirectUrl === \"string\") {\n                await handleIframeRedirect(evt.data.redirectUrl);\n            }\n        }\n        if (window.document.body.contains(iframe)) {\n            window.document.body.removeChild(iframe);\n        }\n    });\n}\nexports.setupIframeListener = setupIframeListener;\nfunction postRedirectUrlToParent(redirectUrl) {\n    window.top.postMessage({\n        redirectUrl,\n    }, window.location.origin);\n}\nexports.postRedirectUrlToParent = postRedirectUrlToParent;\n//# sourceMappingURL=iframe.js.map"]},"metadata":{},"sourceType":"script"}